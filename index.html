
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 門徒訓練 - 雲端實時同步系統</title>
    
    <!-- 外部资源 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Serif+SC:wght@600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        :root { --bg-viewer: #f8fafc; }
        body { 
            font-family: 'Noto Sans SC', sans-serif; 
            background-color: var(--bg-viewer); 
            scroll-behavior: smooth;
        }
        h1, h2, h3, .serif-font { font-family: 'Noto Serif SC', serif; }
        
        @media print {
            .no-print { display: none !important; }
            body { background-color: white !important; padding: 0 !important; }
            section { page-break-after: always; margin-bottom: 0 !important; padding: 0 !important; }
            .bg-white { box-shadow: none !important; border: 1px solid #eee !important; }
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        .scroll-mt-header { scroll-margin-top: 2rem; }
        .accent-gradient-blue { background: linear-gradient(135deg, #2563eb, #1d4ed8); }
        .accent-gradient-emerald { background: linear-gradient(135deg, #059669, #047857); }
        .accent-gradient-amber { background: linear-gradient(135deg, #d97706, #b45309); }

        .sync-active { animation: pulse-green 2s infinite; }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
</head>
<body class="min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useRef } = React;

        // --- 1. 数据常量 ---
        const FRI_STUDENTS = [
            { id: 'm1', zh: '王寶仁', en: '(Heng Poh Luan)' },
            { id: 'm2', zh: '司徒炳雄', en: '(Soo Too Peng Hoong)' },
            { id: 'm3', zh: '蔡懷強', en: '(Chua Hui Keong)' },
            { id: 'm4', zh: '侯玉花', en: '(Hau Yek Hwa)' },
            { id: 'm5', zh: '李業芬', en: '(Lei Yook Fun)' },
            { id: 'm6', zh: '黃雅蘭', en: '(Ah Lan)' },
            { id: 'm7', zh: '林又惠', en: '(Lim You Hwee)' }
        ];

        const SAT_STUDENTS = [
            { id: 'y1', zh: '林以理', en: '(Daniel Lim)' },
            { id: 'y2', zh: '黄榮祖', en: '(Ng Rong Zoe)' },
            { id: 'y3', zh: '劉淇', en: '(Liew Qi)' },
            { id: 'y4', zh: '王伊嫻', en: '(Ong Yi Xian)' },
            { id: 'y5', zh: '劉庭', en: '(Liew Ting)' },
            { id: 'y6', zh: '司徒筱璇', en: '(Soo Too Xiao Xuan)' },
            { id: 'y7', zh: '曾禧銘', en: '(Chin Bai En)' },
            { id: 'y8', zh: '陳玟麟', en: '(Alan Tan Boon Lin)' },
            { id: 'y9', zh: '蔡嘉欣', en: '(Chai Jia Xin)' }
        ];

        const LESSON_TITLES = [
            "我的信仰告白和見證", "每日與神相交的生活", "靈修時間", "活潑有能力的話語", 
            "何謂正確的禱告", "禱告蒙應允", "聖經的權威", "真神是誰", 
            "耶穌基督是誰", "三位一體的神", "人的墮落及結果", "耶穌基督的死亡", 
            "耶穌基督的復活", "按應許而來的聖靈", "重生的人", "信心", 
            "被稱為義的恩典", "內住的聖靈", "基督徒的成聖", "耶穌基督的再來",
            "順服的生活", "服事的義務", "見證耶穌的生活", "說造就人的話", 
            "屬靈的成長", "清潔的生活", "基督徒家庭", "人格塑造", 
            "基督的主權", "管家職分", "屬靈爭戰", "彼此相愛"
        ];

        const PageType = {
            FRI_SCHEDULE: 'fri-schedule',
            SAT_SCHEDULE: 'sat-schedule',
            INFO: 'info',
            FRI_ATTENDANCE: 'fri-attendance',
            SAT_ATTENDANCE: 'sat-attendance'
        };

        const buildSchedule = (type) => {
            const dates = type === 'f' 
                ? ['6/3','13/3','20/3','27/3','3/4','10/4','17/4','24/4','1/5','8/5','15/5','22/5','29/5','5/6','12/6','19/6','26/6','3/7','10/7','17/7','24/7','31/7','7/8','14/8','21/8','28/8','4/9','11/9','18/9','25/9','2/10','9/10','16/10','23/10','30/10','6/11','13/11','20/11','27/11','4/12','11/12','18/12','25/12','1/1/27']
                : ['7/3','14/3','21/3','28/3','4/4','11/4','18/4','25/4','2/5','9/5','16/5','23/5','30/5','6/6','13/6','20/6','27/6','4/7','11/7','18/7','25/7','1/8','8/8','15/8','22/8','29/8','5/9','12/9','19/9','26/9','3/10','10/10','17/10','24/10','31/10','7/11','14/11','21/11','28/11','5/12','12/12','19/12','26/12','2/1/27'];
            let idx = 0;
            return dates.map(date => {
                const isRest = ['20/3','17/4','22/5','29/5','26/6','24/7','21/8','25/9','23/10','20/11','26/12','21/3','18/4','23/5','30/5','27/6','25/7','22/8','26/9','24/10','21/11'].includes(date);
                if (isRest) return { id: `rest-${type}-${date}`, tag: '-', title: '— 休息 —', date, type: 'rest' };
                if (['2/10','3/10'].includes(date)) return { id: `mission-${type}-${date}`, tag: '-', title: '— 短宣 —', date, type: 'mission' };
                const l = { id: `${type}-l${idx + 1}`, tag: `L${(idx % 14) + 1}`, title: LESSON_TITLES[idx] || '課程', date, type: 'normal' };
                idx++;
                return l;
            });
        };

        const FRI_SCHEDULE = buildSchedule('f');
        const SAT_SCHEDULE = buildSchedule('s');
        const FRI_DATES = FRI_SCHEDULE.filter(l => l.type === 'normal').map(l => l.date);
        const SAT_DATES = SAT_SCHEDULE.filter(l => l.type === 'normal').map(l => l.date);

        // --- 2. 界面组件 ---
        const NavigationBar = ({ current, onNavigate }) => {
            const items = [
                { id: PageType.FRI_SCHEDULE, icon: 'fa-calendar-check', label: '週五課表' },
                { id: PageType.SAT_SCHEDULE, icon: 'fa-calendar-day', label: '週六課表' },
                { id: PageType.INFO, icon: 'fa-circle-info', label: '說明' },
                { id: PageType.FRI_ATTENDANCE, icon: 'fa-user-tie', label: '週五點名' },
                { id: PageType.SAT_ATTENDANCE, icon: 'fa-user-graduate', label: '週六點名' },
            ];
            return (
                <nav className="fixed bottom-0 left-0 w-full h-[65px] bg-white/95 backdrop-blur-sm shadow-[0_-2px_20px_rgba(0,0,0,0.08)] flex justify-around items-center z-[2000] pb-[env(safe-area-inset-bottom)] no-print border-t border-slate-100">
                    {items.map(item => (
                        <div key={item.id} onClick={() => onNavigate(item.id)} className={`flex flex-col items-center justify-center cursor-pointer flex-1 h-full transition-all duration-300 relative group ${current === item.id ? 'text-blue-600' : 'text-slate-400 opacity-70 hover:opacity-100'}`}>
                            <i className={`fa-solid ${item.icon} text-lg mb-1 transition-transform group-hover:scale-110 ${current === item.id ? 'scale-110' : ''}`}></i>
                            <span className={`text-[10px] uppercase tracking-wide transition-all ${current === item.id ? 'font-bold' : ''}`}>{item.label}</span>
                            {current === item.id && <div className="absolute bottom-1 w-5 h-0.5 bg-blue-600 rounded-full animate-pulse"></div>}
                        </div>
                    ))}
                </nav>
            );
        };

        const ProgressWidget = ({ friCount, satCount, syncTime, syncStatus, syncKey }) => (
            <div className="fixed bottom-[85px] left-[15px] bg-white/90 backdrop-blur-sm p-4 rounded-2xl shadow-2xl z-[900] border border-slate-100 min-w-[165px] no-print">
                <div className="text-[11px] font-bold mb-2 text-slate-800 flex items-center gap-2">
                    <span className={`w-2.5 h-2.5 rounded-full ${syncStatus === 'loading' ? 'bg-amber-500 animate-spin' : 'bg-emerald-500'} ${syncStatus === 'success' ? 'sync-active' : ''}`}></span>
                    <span className="relative">同步群组: {syncKey}</span>
                </div>
                <div className="space-y-3">
                    <div>
                        <div className="flex justify-between text-[10px] text-slate-600 mb-1 font-medium"><span>週五班</span><span>已上 {friCount} / 32 堂</span></div>
                        <div className="w-full h-[6px] bg-slate-100 rounded-full overflow-hidden">
                            <div className="h-full bg-rose-500 transition-all duration-700" style={{ width: `${(friCount / 32) * 100}%` }}></div>
                        </div>
                    </div>
                    <div>
                        <div className="flex justify-between text-[10px] text-slate-600 mb-1 font-medium"><span>週六班</span><span>已上 {satCount} / 32 堂</span></div>
                        <div className="w-full h-[6px] bg-slate-100 rounded-full overflow-hidden">
                            <div className="h-full bg-emerald-500 transition-all duration-700" style={{ width: `${(satCount / 32) * 100}%` }}></div>
                        </div>
                    </div>
                </div>
                <div className="text-[8px] text-slate-400 mt-3 flex items-center justify-between font-mono">
                    <span>{syncStatus === 'error' ? '连接异常' : '云端同步中'}</span>
                    <span>{syncTime}</span>
                </div>
            </div>
        );

        const SchedulePage = ({ type, lessonChecks, onToggle }) => {
            const isFri = type === 'fri';
            const schedule = isFri ? FRI_SCHEDULE : SAT_SCHEDULE;
            const themeBadge = isFri ? 'accent-gradient-blue' : 'accent-gradient-emerald';

            const renderColumn = (title, subtitle, colorClass, lessons) => (
                <div className="flex flex-col border-r-0 lg:border-r border-dashed border-slate-200 last:border-r-0 lg:pr-6">
                    <div className={`flex items-center justify-between pb-2 mb-3 border-b-2 font-bold ${colorClass}`}>
                        <span className="text-sm">{title}</span>
                        <small className="text-[9px] uppercase tracking-tighter opacity-70">{subtitle}</small>
                    </div>
                    <table className="w-full text-[12px] border-collapse">
                        <tbody>
                            {lessons.map(lesson => {
                                const isChecked = lessonChecks[lesson.id];
                                if (lesson.type === 'rest') return (
                                    <tr key={lesson.id} className="bg-rose-50 text-rose-600 italic">
                                        <td colSpan={2} className="py-1.5 text-center border-b border-rose-100/50 text-[11px] font-medium">{lesson.date} {lesson.title}</td>
                                    </tr>
                                );
                                if (lesson.type === 'mission') return (
                                    <tr key={lesson.id} className="bg-amber-50 text-amber-700 font-bold">
                                        <td colSpan={2} className="py-1.5 text-center border-b border-amber-100/50 text-[11px] font-black italic">{lesson.date} {lesson.title}</td>
                                    </tr>
                                );
                                return (
                                    <tr key={lesson.id} className={`transition-all border-b border-slate-50 ${isChecked ? 'bg-slate-50 text-slate-300 line-through' : 'hover:bg-blue-50/30'}`}>
                                        <td className="py-1.5 w-[75px]">
                                            <label className="flex items-center gap-2.5 cursor-pointer">
                                                <input type="checkbox" checked={!!isChecked} onChange={() => onToggle(lesson.id)} className="w-4 h-4 rounded-md border-slate-300 text-blue-600 focus:ring-blue-500 transition-all" />
                                                <span className="font-bold tracking-tight">{lesson.date}</span>
                                            </label>
                                        </td>
                                        <td className="py-1.5 pl-1">
                                            <span className="inline-block text-[8px] bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded-sm mr-2 font-black align-middle uppercase">{lesson.tag}</span>
                                            <span className="align-middle">{lesson.title}</span>
                                        </td>
                                    </tr>
                                );
                            })}
                        </tbody>
                    </table>
                </div>
            );

            return (
                <div className="bg-white p-8 md:p-10 shadow-2xl rounded-[2.5rem] w-full border border-slate-100 relative overflow-hidden">
                    <div className="absolute top-0 right-0 w-48 h-48 bg-slate-50 rounded-full -mr-20 -mt-20 opacity-50 z-0"></div>
                    <div className="relative z-10">
                        <div className="flex flex-col md:flex-row justify-between items-start md:items-end border-b-2 border-slate-900 pb-5 mb-8">
                            <div>
                                <h1 className="text-4xl font-black text-slate-900 leading-tight">2026 門徒訓練課程表</h1>
                                <div className="text-sm text-slate-400 uppercase mt-2 tracking-[0.2em] font-bold">Discipleship Training Schedule</div>
                            </div>
                            <div className="mt-6 md:mt-0 text-right">
                                <div className={`inline-flex items-center gap-2.5 px-5 py-2.5 rounded-2xl text-white font-bold ${themeBadge} shadow-xl hover:scale-105 transition-transform`}>
                                    <i className={`fa-regular ${isFri ? 'fa-calendar-check' : 'fa-calendar-day'} text-lg`}></i>
                                    {isFri ? '星期五班 (Friday Group)' : '星期六班 (Saturday Group)'}
                                </div>
                            </div>
                        </div>
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-10">
                            {renderColumn('第 1 冊', '門徒訓練的基礎', 'border-blue-600 text-blue-600', schedule.slice(0, 8))}
                            {renderColumn('第 2 冊', '穩如磐石的救恩', 'border-emerald-600 text-emerald-600', schedule.slice(8, 27))}
                            {renderColumn('第 3 冊', '長成基督的身量', 'border-amber-600 text-amber-600', schedule.slice(27))}
                        </div>
                    </div>
                </div>
            );
        };

        const AttendancePage = ({ group, students, dates, attendance, onUpdate, notes, onNotesChange }) => {
            const isMiddle = group === 'middle';
            const [selectedDate, setSelectedDate] = useState(dates[0]);
            const stats = useMemo(() => {
                const dayRecords = attendance[selectedDate] || {};
                const present = Object.values(dayRecords).filter(r => r.status === 1).length;
                return { present, total: students.length };
            }, [selectedDate, attendance, students.length]);
            const themeColor = isMiddle ? 'text-rose-700' : 'text-emerald-700';
            const themeBorder = isMiddle ? 'border-rose-700' : 'border-emerald-700';
            const themeBg = isMiddle ? 'bg-rose-50/50' : 'bg-emerald-50/50';

            return (
                <div className={`bg-white p-8 md:p-10 shadow-2xl rounded-[2.5rem] w-full border border-slate-100 flex flex-col border-t-[12px] ${themeBorder}`}>
                    <div className="flex justify-between items-center pb-6 border-b-2 border-slate-100 mb-8">
                        <div className={`text-3xl font-black flex items-center gap-4 ${themeColor}`}>
                            <div className={`w-12 h-12 rounded-2xl flex items-center justify-center ${isMiddle ? 'bg-rose-100' : 'bg-emerald-100'}`}>
                                <i className={`fa-solid ${isMiddle ? 'fa-user-tie' : 'fa-user-graduate'}`}></i>
                            </div>
                            學員名單 • {isMiddle ? '成人組' : '青年組'}
                        </div>
                    </div>
                    <div className="bg-slate-50/80 p-5 rounded-3xl border border-slate-100 flex flex-wrap justify-between items-center mb-8 gap-5 no-print shadow-inner">
                        <div className="flex items-center gap-4">
                            <span className="text-xs font-black text-slate-500 uppercase tracking-widest">點名日期:</span>
                            <div className="relative">
                                <select value={selectedDate} onChange={e => setSelectedDate(e.target.value)} className="bg-white border rounded-xl px-5 py-2.5 font-black text-slate-800 focus:outline-none shadow-sm appearance-none pr-10 cursor-pointer">
                                    {dates.map(d => <option key={d} value={d}>{d}</option>)}
                                </select>
                                <i className="fa-solid fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none text-xs"></i>
                            </div>
                        </div>
                        <div className={`font-black px-6 py-2.5 rounded-2xl bg-white border-2 shadow-sm flex items-center gap-3 ${themeColor} ${themeBorder}`}>
                            出席率: <span className="text-3xl">{stats.present}</span> / <span className="opacity-50">{stats.total}</span>
                        </div>
                    </div>
                    <div className="overflow-x-auto rounded-3xl border border-slate-100 shadow-sm">
                        <table className="w-full min-w-[650px] text-sm">
                            <thead className="bg-slate-900 text-white font-bold text-[11px] uppercase tracking-[0.2em]">
                                <tr>
                                    <th className="py-4 px-6 text-left">姓名 Name</th>
                                    <th className="py-4 px-6 text-left">備註 Reason</th>
                                    <th className="py-4 px-6 text-center w-[120px]">累計</th>
                                </tr>
                            </thead>
                            <tbody>
                                {students.map(student => {
                                    const record = (attendance[selectedDate] && attendance[selectedDate][student.id]) || { status: 0, reason: '' };
                                    const total = Object.values(attendance).reduce((acc, day) => acc + (day[student.id]?.status === 1 ? 1 : 0), 0);
                                    return (
                                        <tr key={student.id} className={`border-b border-slate-50 transition-all ${record.status === 1 ? themeBg : 'hover:bg-slate-50'}`}>
                                            <td className="py-4 px-6">
                                                <div className="flex items-center gap-4">
                                                    <input type="checkbox" checked={record.status === 1} onChange={e => onUpdate(selectedDate, student.id, e.target.checked ? 1 : 0, record.reason)} className="w-6 h-6 rounded-lg border-slate-300 text-blue-600 cursor-pointer" />
                                                    <div className="flex flex-col"><span className="font-black text-slate-800 text-lg">{student.zh}</span><span className="text-[10px] text-slate-400 font-bold uppercase">{student.en}</span></div>
                                                </div>
                                            </td>
                                            <td className="py-4 px-6">
                                                <input type="text" value={record.reason} onChange={e => onUpdate(selectedDate, student.id, record.status, e.target.value)} placeholder="填寫備註..." className="w-full bg-transparent border-b-2 border-dashed border-slate-200 text-slate-700 focus:outline-none focus:border-blue-400 py-1" />
                                            </td>
                                            <td className="py-4 px-6 text-center">
                                                <span className={`inline-flex items-center justify-center w-10 h-10 rounded-full font-black text-xs shadow-sm ${total > 0 ? 'bg-blue-600 text-white' : 'bg-slate-100 text-slate-400'}`}>{total}</span>
                                            </td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>
                    </div>
                    <div className="mt-10 p-8 bg-slate-50/50 rounded-[2rem] border-2 border-dashed border-slate-200">
                        <div className="flex items-center gap-3 mb-4 text-slate-800 font-black text-xl"><i className="fa-solid fa-scroll text-blue-500"></i> 每週重要筆記 / 禱告項</div>
                        <textarea value={notes} onChange={e => onNotesChange(e.target.value)} placeholder="記錄學員分享或禱告清單..." className="w-full min-h-[140px] p-6 bg-white border border-slate-100 rounded-3xl focus:outline-none focus:ring-4 focus:ring-blue-100 resize-none text-slate-700 shadow-sm leading-relaxed"></textarea>
                    </div>
                </div>
            );
        };

        // --- 3. 主程序 (加入云端同步逻辑) ---
        const App = () => {
            const [activeSection, setActiveSection] = useState(PageType.FRI_SCHEDULE);
            const [lastSync, setLastSync] = useState(new Date().toLocaleTimeString());
            const [syncStatus, setSyncStatus] = useState('success'); 
            const [syncKey, setSyncKey] = useState(() => localStorage.getItem('ds_sync_key') || 'discipleship-2026');
            
            const [state, setState] = useState(() => {
                const saved = localStorage.getItem('ds_system_2026_all_in_one');
                return saved ? JSON.parse(saved) : { attendance: {}, lessonChecks: {}, notes: { fri: '', sat: '' } };
            });

            const SYNC_URL = `https://kvdb.io/AueXhApxW22j65N81895pM/${syncKey}`;

            const pushToCloud = async (dataToPush) => {
                setSyncStatus('loading');
                try {
                    await fetch(SYNC_URL, {
                        method: 'POST',
                        body: JSON.stringify(dataToPush),
                        headers: { 'Content-Type': 'application/json' }
                    });
                    setSyncStatus('success');
                    setLastSync(new Date().toLocaleTimeString());
                } catch (e) {
                    setSyncStatus('error');
                }
            };

            const pullFromCloud = useCallback(async () => {
                setSyncStatus('loading');
                try {
                    const res = await fetch(SYNC_URL);
                    if (res.ok) {
                        const cloudData = await res.json();
                        setState(prev => ({ ...prev, ...cloudData }));
                        setSyncStatus('success');
                        setLastSync(new Date().toLocaleTimeString());
                    }
                } catch (e) {
                    setSyncStatus('error');
                }
            }, [SYNC_URL]);

            useEffect(() => {
                pullFromCloud();
                const timer = setInterval(pullFromCloud, 30000);
                return () => clearInterval(timer);
            }, [pullFromCloud]);

            useEffect(() => {
                localStorage.setItem('ds_system_2026_all_in_one', JSON.stringify(state));
            }, [state]);

            const updateAttendance = (date, sid, status, reason) => {
                const nextState = { ...state };
                if (!nextState.attendance[date]) nextState.attendance[date] = {};
                nextState.attendance[date][sid] = { status, reason };
                setState({ ...nextState });
                pushToCloud(nextState);
            };

            const toggleLesson = (id) => {
                const nextState = { ...state, lessonChecks: { ...state.lessonChecks, [id]: !state.lessonChecks[id] } };
                setState(nextState);
                pushToCloud(nextState);
            };

            const handleNavigate = (id) => {
                const el = document.getElementById(id);
                if (el) el.scrollIntoView({ behavior: 'smooth' });
                setActiveSection(id);
            };

            const updateSyncKey = () => {
                const newKey = prompt("设置群组同步暗号（建议大家使用同一个暗号）：", syncKey);
                if (newKey && newKey.trim() !== "") {
                    setSyncKey(newKey.trim());
                    localStorage.setItem('ds_sync_key', newKey.trim());
                    window.location.reload();
                }
            };

            const lessonStats = useMemo(() => ({
                fri: Object.keys(state.lessonChecks).filter(k => k.startsWith('f-l') && state.lessonChecks[k]).length,
                sat: Object.keys(state.lessonChecks).filter(k => k.startsWith('s-l') && state.lessonChecks[k]).length
            }), [state.lessonChecks]);

            return (
                <div className="flex flex-col items-center gap-16 pb-32 pt-12 px-4 md:px-8">
                    <div className="w-full max-w-[1100px] flex flex-col gap-16 md:gap-24">
                        <section id={PageType.FRI_SCHEDULE} className="scroll-mt-header"><SchedulePage type="fri" lessonChecks={state.lessonChecks} onToggle={toggleLesson} /></section>
                        <section id={PageType.SAT_SCHEDULE} className="scroll-mt-header"><SchedulePage type="sat" lessonChecks={state.lessonChecks} onToggle={toggleLesson} /></section>
                        <section id={PageType.INFO} className="scroll-mt-header">
                            <div className="w-full flex flex-col gap-12">
                                <div className="bg-white p-10 md:p-14 shadow-2xl rounded-[3rem] border border-slate-100 relative overflow-hidden group">
                                    <div className="absolute top-0 right-0 w-64 h-64 bg-blue-50/50 rounded-full -mr-32 -mt-32 transition-transform group-hover:scale-110 duration-1000"></div>
                                    <div className="relative z-10 text-center md:text-left flex flex-col md:flex-row justify-between items-center md:items-end gap-8">
                                        <div>
                                            <span className="bg-blue-100 text-blue-700 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-[0.3em] mb-4 inline-block">Cloud Sync System</span>
                                            <h1 className="text-4xl md:text-5xl font-black text-slate-900 serif-font leading-[1.2]">門徒訓練實時同步系統</h1>
                                            <p className="text-slate-500 font-bold mt-3 text-sm flex items-center gap-2">
                                                <i className="fa-solid fa-users-viewfinder text-blue-500"></i>
                                                当前同步群组: <span className="bg-slate-100 px-3 py-1 rounded-lg text-slate-800 font-black">{syncKey}</span>
                                            </p>
                                        </div>
                                        <div className="flex gap-3">
                                            <button onClick={updateSyncKey} className="px-6 py-3 bg-slate-900 text-white rounded-2xl font-black text-xs hover:bg-blue-600 transition-all shadow-xl no-print active:scale-95">
                                                <i className="fa-solid fa-key mr-2"></i> 更換同步群組
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section id={PageType.FRI_ATTENDANCE} className="scroll-mt-header"><AttendancePage group="middle" students={FRI_STUDENTS} dates={FRI_DATES} attendance={state.attendance} onUpdate={updateAttendance} notes={state.notes.fri} onNotesChange={c => {setState(p => ({...p, notes: {...p.notes, fri: c}})); pushToCloud({...state, notes: {...state.notes, fri: c}});}} /></section>
                        <section id={PageType.SAT_ATTENDANCE} className="scroll-mt-header"><AttendancePage group="youth" students={SAT_STUDENTS} dates={SAT_DATES} attendance={state.attendance} onUpdate={updateAttendance} notes={state.notes.sat} onNotesChange={c => {setState(p => ({...p, notes: {...p.notes, sat: c}})); pushToCloud({...state, notes: {...state.notes, sat: c}});}} /></section>
                    </div>

                    <ProgressWidget friCount={lessonStats.fri} satCount={lessonStats.sat} syncTime={lastSync} syncStatus={syncStatus} syncKey={syncKey} />
                    <NavigationBar current={activeSection} onNavigate={handleNavigate} />
                    
                    <div className="fixed bottom-[85px] right-[25px] flex flex-col gap-5 z-[1000] no-print">
                        <button onClick={() => pullFromCloud()} title="立即同步云端数据" className={`w-14 h-14 rounded-2xl ${syncStatus === 'loading' ? 'bg-amber-500' : 'bg-blue-600'} text-white flex items-center justify-center shadow-2xl hover:scale-110 active:scale-95 transition-all`}>
                            <i className={`fa-solid ${syncStatus === 'loading' ? 'fa-spinner fa-spin' : 'fa-arrows-rotate'} text-xl`}></i>
                        </button>
                        <button onClick={() => window.print()} title="打印当前页面" className="w-14 h-14 rounded-2xl bg-slate-900 text-white flex items-center justify-center shadow-2xl hover:scale-110 active:scale-95 transition-all">
                            <i className="fa-solid fa-print text-xl"></i>
                        </button>
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
